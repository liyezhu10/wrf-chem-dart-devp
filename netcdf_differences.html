<HTML>
<HEAD>
<TITLE>DART Documentation Index</TITLE>
<link rel="stylesheet" type="text/css" href="doc/html/doc.css" />
<link href="doc/images/dart.ico" rel="shortcut icon" />
</HEAD>
<BODY>
<A NAME="TOP"></A>

<H1>Netcdf-io changes from Trunk</H1>

<table border=0 summary="" cellpadding=5>
<tr>
    <td valign=middle>
    <img src="doc/images/Dartboard7.png" alt="DART project logo" height=70 />
    </td>
    <td>
       <P><!-- already here: Jump to <a href="index.html">DART Documentation Main Index</a --><br />
          <small><small>version information for this file: <br />
          <!-- version tag follows, do not edit -->
          $Id$</small></small>
       </P></td>
</tr>
</table>

<A HREF="#Namelist Options">Namelist Options</A> /
<A HREF="#Legalese">Terms of Use</A>

<H2>Namelist Options</H2>

There are two new nameslists, io_filenames_nml and state_vector_io_nml, and some changes to filter_nml. 

<P>
<div class=namelist>
<pre>
&amp;io_filenames_nml
   restart_in_stub  = 'advance_temp'
   restart_out_stub = 'filter_restart'
   overwrite_input  = .false.
/
</pre>
</div>
<P>
<ul>
<li>Here is an example of how the restart_in_stub is used to construct the input filenames.
<P>
restart_in_stub = 'advance_temp' for a 2 domain case:
<P>
filenames: <br>
advance_temp1/wrfinput_d01 <br>
advance_temp1/wrfinput_d02 <br>
advance_temp2/wrfinput_d01 <br>
advance_temp2/wrfinput_d02 <br>
advance_temp3/wrfinput_d01 <br>
advance_temp3/wrfinput_d02 <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#8942; <br>
advance_temp50/wrfinput_d01 <br>
advance_temp50/wrfinput_d02 <br>

<P>
<li>Here is an example of how the restart_out_stub is used to construct the output filenames
<P>
restart_out_stub = 'filter_restart' for a 2 domain case:
<P>
filenames:<br>
filter_restart_d01.01 <br>
filter_restart_d02.01 <br>
filter_restart_d01.02 <br>
filter_restart_d02.02 <br>
filter_restart_d01.03 <br>
filter_restart_d02.03 <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#8942; <br>
filter_restart_d01.50 <br>
filter_restart_d02.50 <P>

Filter will overwrite the state variables in existing files, or create new netcdf files.

<P>
<li>overwrite_input = .true. overrides the restart_out_stub and sets the output file to be
the same as the input file.  This will <em>overwrite</em>  the state variables in your <em>input</em> files.
</ul>


<div class=namelist>
<pre>
&amp;state_vector_io_nml
   single_precision_output = .false.
   create_restarts         = .false.
   time_unlimited          = .true.
/
</pre>
</div>

<P>
single_precision_output = <em>.true.</em> forces filter to create single precisiion netcdf restart files
regardless of the precision set in filter (r4 or r8). Note if the netcdf files already
exist, filter will not change the precision of the variables.
<P>
create_restarts = <em>.true.</em>  clobbers exitsing netcdf files (creates a new file instead of
overwriting variables).  The default is to overwrite variables in an existing file. If no file
exists one will be created.
<P>
time_unlimited = .true. makes time the unlimited dimension in any output netcdf files
created by DART.
<P>


<div class=namelist>
<pre>
&amp;filter_nml
   diagnostic_files            = .false.
   output_inflation            = .true.
   num_output_state_members    = 0,
   inf_output_restart          = .false., .false.,
   direct_netcdf_read          = .true.
   inf_in_file_name            = 'prior_inf', 'post_inf',
   inf_out_file_name           = 'prior_inf_ic_new', 'post_inf_ic_new',
/
</pre>
</div>
<P>
<ul>
<li>
diagnostic_files = .true. will write disgnoistc files (Prior_Diag.nc and Post_Diag.nc).
The default is not to write these because all the ouptut is netcdf. <P>

<ul>
<li>If diagnostic_files = <em>.true. </em>:<P>
&nbsp;&nbsp;output_inflation = .true. will write both the inflation mean and sd in both the
Prior and Posterior Diag files (same as trunk behaviour)<P>
&nbsp;&nbsp;num_output_state_members = * will be written in to the diagnostic files.
<li>If diagnostic_files = <em> .false. </em>:<P>
&nbsp;&nbsp;The information that would have gone in
Prior_Diag.nc will be written out as separate
netcdf files:<P>
&nbsp;&nbsp;PriorDiag_sd_d01.nc<br>
&nbsp;&nbsp;PriorDiag_mean_d01.nc<br>
&nbsp;&nbsp;PriorDiag_inf_sd_d01.nc <em> (optional output_inflation = .true.) </em> <br>
&nbsp;&nbsp;PriorDiag_inf_mean_d01.nc<em> (optional output_inflation = .true.) </em> <P>

&nbsp;&nbsp;The posterior inflation files are only written out if the <em>posterior</em> inf_output_restart is set to true: <P>
&nbsp;&nbsp;inf_output_restart          = .true.,  &nbsp; <em>.true.</em><P>
&nbsp;&nbsp;num_output_state_members = * will be written to netcdf files<p>
&nbsp;&nbsp;prior_member_d01.0001, prior_member_d01.0002, etc.
</ul>

<P>
<li>Inflation files are split into <em> n </em> files for <em> n </em> domains. The filenames
are<P>
inf_in_file_name<em>_d01</em>, inf_in_file_name<em>_d02</em>, etc.<br>
inf_out_file_name<em>_d01</em>, inf_out_file_name<em>_d02</em>, etc.
<P>

<P>
<li>For restart files:<P>
direct_netcdf_read = .true. <br>
<ul>
<li>reads the state variables from the filenames constructed
from restart_in_stub<P>
<li>writes the state variables to the filenames constructed
from restart_out_stub or the input files if desired. <P>
</ul>
direct_netcdf_read = .false. reads from dart restart files (same behaviour as trunk)<P>
</ul>



<!--==================================================================-->
<!-- Legalese & Metadata                                              -->
<!--==================================================================-->

<A NAME="Legalese"></A>
<div class="top">[<a href="#">top</a>]</div><hr />
<H2>Terms of Use</H2>

<P>
DART software - Copyright 2004 - 2013 UCAR.<br>
This open source software is provided by UCAR, "as is",<br>
without charge, subject to all terms of use at<br>
<a href="http://www.image.ucar.edu/DAReS/DART/DART_download">
http://www.image.ucar.edu/DAReS/DART/DART_download</a>
</P>

<TABLE border=0 cellpadding=0 width=100% summary="">
<TR><TD valign=top>Contact:       </TD><TD> DART core group   </TD></TR>
<TR><TD>Revision:      </TD><TD> $Revision$ </TD></TR>
<TR><TD>Source:        </TD><TD> $URL$ </TD></TR>
<TR><TD>Change Date:   </TD><TD> $Date$ </TD></TR>
<TR><TD valign=top>Change&nbsp;history:&nbsp;</TD><TD> try "svn&nbsp;log" or "svn&nbsp;diff" </TD></TR>
</TABLE>

<!--==================================================================-->

</BODY>
</HTML>
