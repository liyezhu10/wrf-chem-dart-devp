<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
          "http://www.w3.org/TR/html4/strict.dtd">
<HTML>
<HEAD>
<TITLE>program integrate_model</TITLE>
<link rel="stylesheet" type="text/css" href="../doc/html/doc.css" />
<link href="../doc/images/dart.ico" rel="shortcut icon" />
</HEAD>
<BODY>
<A NAME="TOP"></A>

<H1>PROGRAM <em class=program>integrate_model</em></H1>

<table border=0 summary="" cellpadding=5>
<tr>
    <td valign=middle>
    <img src="../doc/images/Dartboard7.png" alt="DART project logo" height=70 />
    </td>
    <td>
       <P>Jump to <a href="../index.html">DART Documentation Main Index</a><br />
          <small><small>version information for this file: <br />
          <!-- version tag follows, do not edit -->
          $Id$</small></small>
       </P></td>
</tr>
</table>

<A HREF="#Namelist">NAMELIST</A> /
<A HREF="#FilesUsed">FILES</A> /
<A HREF="#References">REFERENCES</A> /
<A HREF="#Errors">ERRORS</A> /
<A HREF="#FuturePlans">PLANS</A> /
<A HREF="#Legalese">TERMS OF USE</A>

<H2>Overview</H2>

<P>
  Generic main program which can be compiled with a model-specific
  <em class="file">model_mod.f90</em> file.  The model must provide
  an <em class="code">adv_1step()</em> subroutine which advances one
  copy of the model forward in time.  
</P><P>
  The executable built by this program can be used by the serial
  program <em class="program">perfect_model_obs</em>, or 
  either the serial
  or parallel version of the <em class="program">filter</em> program.  
  This program is called by the default script in the template directory
  called <em class="code">advance_model.csh</em>, and is selected by
  setting the corresponding <em class="code">"async = "</em> namelist 
  setting to 2.
</P><P>
  This program only advances a single ensemble member per execution and 
  is expected to be run as a serial program.
  It can be compiled with the MPI wrappers and called with mpirun with more
  than 1 task, however, it will
  only call the model advance subroutine from a single task (task 0).  
  This can be
  useful in testing various scripting options using simpler and smaller
  models in preparation for running a larger parallel model.
</P>

<br />
<br />

<!--==================================================================-->
<!--============== DESCRIPTION OF A NAMELIST ========================-->
<!--==================================================================-->

<A NAME="Namelist"></A>
<div class="top">[<a href="#">top</a>]</div><hr />
<H2>NAMELIST</H2>
<P>
This namelist is read from the file <em class=file>input.nml</em>.
Namelists start with an ampersand
'&amp;' and terminate with a slash '/'.
Character strings that contain a '/' must be
enclosed in quotes to prevent them from
prematurely terminating the namelist.
</P>

<div class=namelist>
<pre>
&amp;integrate_model_nml
   ens_size                    =  1
   input_filename              = "temp_ic" 
   output_filename             = "temp_ud"
   write_binary_restart_files  = .true.
   trace_execution             = .false.
   input_is_model_advance_file = .true.
   target_days                 = -1
   target_seconds              = -1
   init_days                   = -1
   init_seconds                = -1
   single_restart_file_in      = .true.
   single_restart_file_out     = .true.
   /
</pre>
</div>

<br />
<br />


<div>
<TABLE border=0 cellpadding=10 width=100% summary='namelist description'>
<THEAD align=left>
<TR><TH> Item </TH>
    <TH> Type </TH>
    <TH> Description </TH> </TR>
</THEAD>

<TBODY valign=top>

<TR><TD> ens_size </TD>
    <TD> integer </TD>
    <TD> the number of ensemble members to be advanced by this call to the program
</TD></TR>

<TR><TD> input_filename </TD>
    <TD> character(len=256) </TD>
    <TD> the filename to read for the input ensemble member data
</TD></TR>

<TR><TD> ouput_filename </TD>
    <TD> character(len=256) </TD>
    <TD> the filename to write for the output ensemble member data
</TD></TR>

<TR><TD> write_binary_restart_files </TD>
    <TD> logical </TD>
    <TD> if true, write the output in binary format.  if false, write in ascii
</TD></TR>

<TR><TD> trace_execution </TD>
    <TD> logical </TD>
    <TD> set to true for more debugging/tracing info
</TD></TR>

<TR><TD> is_model_advance_file </TD>
    <TD> logical </TD>
    <TD> if the input file was written by filter, it contains two timestamps.  one is
the current time of the model state, and the other is the 'advance_to' time which is
how far this program should integrate the model forward.  if true, the input file
is expected to have both timestamps.  if false, the input file will be expected to
have only a single timestamp for the current model time.
</TD></TR>

<TR><TD> target_days </TD>
    <TD> integer </TD>
    <TD> override or supply the 'advance_to' time.  the model will be integrated
forward until this time.  set to -1 to be ignored.
</TD></TR>

<TR><TD> target_seconds </TD>
    <TD> integer </TD>
    <TD> override or supply the 'advance_to' time.  the model will be integrated
forward until this time.  set to -1 to be ignored.
</TD></TR>

<TR><TD> init_days </TD>
    <TD> integer </TD>
    <TD> if specified, override the model time in the input file.  set to -1 to
be ignored.
</TD></TR>

<TR><TD> init_seconds </TD>
    <TD> integer </TD>
    <TD> if specified, override the model time in the input file.  set to -1 to
be ignored.
</TD></TR>

<TR><TD> single_restart_file_in </TD>
    <TD> logical </TD>
    <TD> if true, all ensemble members are expected to be in a single input file.
if false, the ensemble number will be appended to the input filename: 
<tt> input_filename.NNNN </tt> where <tt>NNNN</tt> is the ensemble number 
padded with leading zeros.
</TD></TR>

<TR><TD> single_restart_file_out </TD>
    <TD> logical </TD>
    <TD> if true, all ensemble members will be written to a single output file.
if false, the ensemble number will be appended to the output filename: 
<tt> output_filename.NNNN </tt> where <tt>NNNN</tt> is the ensemble number 
padded with leading zeros.
</TD></TR>

</TBODY>
</TABLE>
</div>

<br />
<br />


<!--==================================================================-->

<A NAME="Modules"></A>
<div class="top">[<a href="#">top</a>]</div><hr />
<H2>MODULES USED</H2>
<PRE>
types_mod
time_manager_mod
utilities_mod
assim_model_mod
obs_model_mod
ensemble_manager_mod
mpi_utilities_mod
</PRE>

<!--==================================================================-->
<!-- Describe the Files Used by this module.                          -->
<!--==================================================================-->

<A NAME="FilesUsed"></A>
<div class="top">[<a href="#">top</a>]</div><hr />
<H2>FILES</H2>
<UL> <LI>input_filename
     <LI>output_filename
</UL>

<!--==================================================================-->
<!-- Cite references, if need be.                                     -->
<!--==================================================================-->

<A NAME="References"></A>
<div class="top">[<a href="#">top</a>]</div><hr />
<H2>REFERENCES</H2>
<ul>
<li> none </li>
</ul>

<!--==================================================================-->
<!-- Describe all the error conditions and codes.                     -->
<!--==================================================================-->

<A NAME="Errors"></A>
<div class="top">[<a href="#">top</a>]</div><hr />
<H2>ERROR CODES and CONDITIONS</H2>
<div class=errors>
<TABLE border=1 cellspacing=1 cellpadding=10 width=100%>
<TR><TH>Routine</TH><TH>Message</TH><TH>Comment</TH></TR>

<TR><!-- routine --><TD VALIGN=top>integrate_model</TD>
    <!-- message --><TD VALIGN=top>none</TD>
    <!-- comment --><TD VALIGN=top>none</TD>
</TR>
</TABLE>
</div>

<H2>KNOWN BUGS</H2>
<P>
none
</P>

<!--==================================================================-->
<!-- Describe Future Plans.                                           -->
<!--==================================================================-->

<A NAME="FuturePlans"></A>
<div class="top">[<a href="#">top</a>]</div><hr />
<H2>FUTURE PLANS</H2>
<P>
A true MPI version of this program could advance multiple
ensemble members at a time, one per MPI task.
</P>

<!--==================================================================-->
<!-- Legalese & Metadata                                              -->
<!--==================================================================-->

<A NAME="Legalese"></A>
<div class="top">[<a href="#">top</a>]</div><hr />
<H2>Terms of Use</H2>

<P>
DART software - Copyright 2004 - 2013 UCAR.<br>
This open source software is provided by UCAR, "as is",<br>
without charge, subject to all terms of use at<br>
<a href="http://www.image.ucar.edu/DAReS/DART/DART_download">
http://www.image.ucar.edu/DAReS/DART/DART_download</a>
</P>

<TABLE border=0 cellpadding=0 width=100% summary="">
<TR><TD valign=top>Contact:       </TD><TD> DART core group   </TD></TR>
<TR><TD valign=top>Revision:      </TD><TD> $Revision$ </TD></TR>
<TR><TD valign=top>Source:        </TD><TD> $URL$ </TD></TR>
<TR><TD valign=top>Change Date:   </TD><TD> $Date$ </TD></TR>
<TR><TD valign=top>Change&nbsp;history:&nbsp;</TD><TD> try "svn&nbsp;log" or "svn&nbsp;diff" </TD></TR>
</TABLE>

<!--==================================================================-->

</BODY>
</HTML>
